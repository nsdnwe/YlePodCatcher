!function(a,b){"use strict";"function"==typeof define&&define.amd?define("yleHeaderNotifications",["jquery"],b):a.yleHeaderNotifications=b(jQuery)}(this,function(a){"use strict";function b(){var b=d();a(".yle__global-header__tunnus__toggle__icon__notify").css("display","block").text(b.length)}function c(a){a.hasOwnProperty("read")||(a.read=!1),g=g.concat(a),a.read||e()}function d(){return a(g).filter(function(a,b){return!b.read})}function e(){b()}function f(){0!==g.length&&(a.each(g,function(a,b){"function"==typeof b.onDenotify&&b.onDenotify()}),a(".yle__global-header__tunnus__toggle__icon__notify").hide())}var g=[];return{notify:e,denotify:f,addNotification:c}}),function(a,b){"use strict";window.yleHeaderVersion="1.0","function"==typeof define&&define.amd?define("yleHeader",["yleHeaderNotifications","jquery","typeahead"],b):a.yleHeader=b(a.yleHeaderNotifications,jQuery,jQuery.fn.typeahead)}(this,function(a,b){"use strict";function c(a){return function(c){var d=13===c.keyCode;d&&(c.preventDefault(),b(a).click())}}var d={},e=null,f=function(){var a=null;return function(c,d){return b.isFunction(c)?(clearTimeout(a),a=setTimeout(c,d||200),void 0):!1}}();return d.sendTrackingEvent=function(a,b){if("undefined"!=typeof yleAnalytics){var c=a.tracking.account;yleAnalytics.comscore.trackEvent(c,b,null)}},d.Search=function(a,c,e){function g(a,c,d){var e="json_yle";"sv"===b(".yle__global-header").attr("language")&&(e="json_yle_svenska"),b.ajax("//haku.yle.fi/api/suggest?frontend="+e+"&q="+encodeURIComponent(a),{dataType:"jsonp",cache:!0,success:function(a){var c=b.map(a.results,function(a){return{value:JSON.parse('"'+a.name+'"')}});d(c)}})}function h(a){var c=document.querySelector(a),d=0,e=0,f=null;return c&&b.isFunction(c.getBoundingClientRect)&&(f=window.getComputedStyle(c),e=c.getBoundingClientRect().width,f.display&&"none"!=f.display&&(d=parseFloat(f.marginLeft)+parseFloat(f.marginRight))),e+d}function i(){var a=h(".yle__global-header__tunnus__toggle"),c=h(".yle__global-header__navigation__toggle"),d=h(".yle__global-header__search__form__submit"),e=h(".yle__global-header__search__form__input"),f=document.querySelector(".yle__global-header__search__form__input"),g=(b(".yle__global-header__navigation__seach").outerWidth(!0),b(f).innerWidth()-b(f).width()),i=parseFloat(b(".yle__global-header__wrap").css("padding-left")),j=parseFloat(b("body").css("margin-left")),k=parseFloat(b("body").css("margin-right")),l=parseFloat(b(".yle__global-header__navigation").css("margin-right")),m=b(window).width()-a-c-d-g-j-k-l,o=m+g+d-i-j,p=navigator.userAgent.toLowerCase().indexOf("msie")>-1;return p&&(m-=1),e>m&&n.addClass("disable-transitions"),{input:m,suggestions:o}}function j(d){var f=b(".yle__global-header__search__form__input"),g=b(".yle__global-header__search__form__input:focus").length>0,h=b(".tt-menu"),j=parseInt(a.search.inputWidth,10),k=parseInt(c.search.inputWidth,10),l=j,m=j,o=0,q=0;if(g!==!1){if(g){var r=1e3+(j-k);b(".yle__global-header__tunnus__toggle").toggle(b(window).width()>r)}if(b(window).width()<=800){g&&e.setMode("close-search");var s=i();l=s.input,m=s.suggestions,o="-"+b(".yle__global-header__wrap").css("padding-left"),q="-"+b(".yle__global-header__wrap").css("padding-right")}else g&&e.setMode("menu"),m+=p.outerWidth(!0)+(n.innerWidth()-n.width());f.css({width:l+"px","margin-left":o,"margin-right":q}),h.css({width:m+"px",left:"0","margin-left":o,"margin-right":q}),b.isFunction(d)&&d()}}function k(a,b){var c={};if("object"==typeof b&&b.hasOwnProperty("value"))var c={ns_partial_search_term:r,ns_search_term:b.value};var d=document.querySelector(".yle__global-header__search__form");null!==d&&"undefined"!=typeof yleAnalytics&&yleAnalytics.trackForm(d,{labels:c}),q.submit(),n.typeahead("val","").val("").blur()}function l(){setTimeout(function(){j(function(){p.addClass(o),n.addClass(o),n.removeClass("disable-transitions"),d.sendTrackingEvent(a,"header-searchfield-click")})},10)}function m(){var a=b(this).css("margin-left"),c=b(this).css("margin-right");setTimeout(function(){n.removeClass(o,"disable-transitions").removeAttr("style").css({"margin-left":a,"margin-right":c}),p.removeClass(o),setTimeout(function(){b(".yle__global-header__tunnus__toggle").show(),e.setMode("menu"),s=0},100)},1)}var n=b(".yle__global-header__search__form__input"),o="yle__global-header__search__form__input--background--focus",p=b(".yle__global-header__search__form__submit"),q=b(".yle__global-header__search__form"),r="",s=0,t=a.search.source||{async:!0,name:"global-header-search",displayKey:"value",source:g},u=b.extend({},{hint:!1,highlight:!0,minLength:1},a.search.options);n.typeahead(u,t).on("focus",l).on("typeahead:close",m).on("keydown",function(){r=n.val()}).on("typeahead:select",k).on("click",j),b(window).on("resize",function(){f(j,200)}).on("orientationchange",j),p.on("click",function(a){a.preventDefault(),s>0||n.val().length>0?k():(s++,n.focus())})},d.Navigation=function(a){var e=b(".yle__global-header__navigation__toggle"),f="yle__global-header__navigation__links--open",g=null,h=function(a){"menu"===a&&(e.removeClass("yle__global-header__navigation__toggle--close-search"),b(".yle__global-header__navigation__toggle__icon").addClass("yle__global-header__icon-menu").removeClass("yle__global-header__icon-cancel"),b(window).width()>=640&&b(".yle__global-header__navigation__toggle__text").removeAttr("style")),"close-search"===a&&(e.addClass("yle__global-header__navigation__toggle--close-search"),b(".yle__global-header__navigation__toggle__icon").removeClass("yle__global-header__icon-menu").addClass("yle__global-header__icon-cancel"),b(window).width()>=640&&b(".yle__global-header__navigation__toggle__text").hide())},i=function(c){if(null===g){var i=e.hasClass("yle__global-header__navigation__toggle--close-search");if(i)return h("menu"),b(".yle__global-header__search__form__input").trigger("blur"),!1;var j=b(".yle__global-header__navigation__links");j.hasClass(f)?(j.attr("aria-hidden",!0),b(".yle__global-header").trigger("menu-close"),e.removeClass("yle__global-header__toggle--active")):(j.attr("aria-hidden",!1),d.sendTrackingEvent(a,"header-menuicon-click"),b(".yle__global-header").trigger("menu-open"),e.addClass("yle__global-header__toggle--active")),c.preventDefault(),j.toggleClass(f)}};return e.on("touchstart",function(){g=document.body.scrollTop}).on("touchend",function(a){document.body.scrollTop===g&&i(a),g=null}).on("click",i).on("keypress",c(".yle__global-header__navigation__toggle")),{setMode:h}},d.Tunnus=function(e){function f(){if(v)return v;var a=e.loginApiAppId||e.profilesApiAppId,c=e.loginApiAppKey||e.profilesApiAppKey,d="https://login."+(e.test?"api-test":"api")+".yle.fi/v1/account/email?app_id="+a+"&app_key="+c;b.ajax({url:d,xhrFields:{withCredentials:!0},success:function(a){"object"==typeof a&&a.email&&(b(".yle__global-header__tunnus__links__email").text(a.email),g(a.email)())}})}function g(a){return v=a,function(){b(".yle__global-header__tunnus__toggle__text--logged_in").text(h(a))}}function h(a){if(null==a)return"";var c=a.split("@"),d=b(window).width();return d>768?a:768>=d&&d>=640?c[0]:""}function i(){b(window).width()>640&&b(".yle__global-header__tunnus__toggle__text--login").show(),b(".yle__global-header__tunnus__toggle__text--logged_in").hide(),0===b(".yle__global-header__tunnus__login").length&&(b(".yle__global-header__tunnus__navigation").off("click",k),b(".yle__global-header__tunnus__toggle").removeClass("yle__global-header__tunnus__navigation").addClass("yle__global-header__tunnus__login")),b(".yle__global-header__tunnus").show(),v=null,t(u)}function j(){b(window).width()>640&&b(".yle__global-header__tunnus__toggle__text--logged_in").show(),b(".yle__global-header__tunnus__toggle__text--login").hide(),0===b(".yle__global-header__tunnus__navigation").length&&(b(".yle__global-header__tunnus__toggle").removeClass("yle__global-header__tunnus__login").addClass("yle__global-header__tunnus__navigation"),b(".yle__global-header__tunnus__navigation").on("click",k)),b(".yle__global-header__tunnus").show()}function k(a){a.preventDefault();var c=b(".yle__global-header__tunnus__links");c.hasClass("yle__global-header__tunnus__links--open")?(b(".yle__global-header").trigger("menu-close"),c.attr("aria-hidden",!0),c.removeClass("yle__global-header__tunnus__links--open"),b(".yle__global-header__tunnus__toggle").removeClass("yle__global-header__toggle--active")):(b(".yle__global-header").trigger("menu-open"),c.attr("aria-hidden",!1),c.addClass("yle__global-header__tunnus__links--open"),b(".yle__global-header__tunnus__toggle").addClass("yle__global-header__toggle--active"))}function l(a,b,c){var d=window.location.search.indexOf("tos_dialog_seen=true")>-1,e=s(u);c||e||d||(n(),r(u,!0,1)),f(),j()}function m(a,b,c){l(a,b,c)}function n(){b.ajax({url:"https://tunnus-tos.ylestatic.fi/_version",method:"GET",success:function(a){b(".ylefi__tunnus-tos-accept__dialog").removeClass("ylefi__tunnus-tos-accept__dialog--hidden"),b(".ylefi__tunnus-tos-accept__button").on("click",function(){d.sendTrackingEvent(e,"accept-tos-click"),o(a)})}})}function o(a){var c=e.loginApiAppId,d=e.loginApiAppKey,f="https://login."+(e.test?"api-test":"api")+".yle.fi/v1/terms-of-service/accepted/"+a+"?app_id="+c+"&app_key="+d;b.ajax({url:f,method:"POST",xhrFields:{withCredentials:!0},success:function(){p()},error:function(){p()}})}function p(){b(".ylefi__tunnus-tos-accept__button").off("click"),b(".ylefi__tunnus-tos-accept__dialog").addClass("ylefi__tunnus-tos-accept__dialog--hidden")}function q(){a.denotify(),d.sendTrackingEvent(e,"header-tunnusicon-click")}function r(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+1e3*60*60*24*c);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/; domain=yle.fi"}function s(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return!1}function t(a){r(a,"",-1)}var u="ylefi_tos_dialog_seen",v=null;return b(".yle__global-header__tunnus__toggle").on("click",q).on("keypress",c(".yle__global-header__tunnus__toggle")),b(".yle__global-header__tunnus__links__logout").on("click",function(){d.sendTrackingEvent(e,"header-tunnuslogout-click")}),b(window).on("orientationchange",function(){g(v)()}).on("resize",function(){g(v)()}),b(".ylefi__tunnus-tos-accept-later__link").on("click",function(){p(),d.sendTrackingEvent(e,"accept-tos-later-click")}),{onLoginSuccess:l,onAlreadyLoggedIn:m,onLogoutSuccess:i,onLogoutFailed:i,onLoginFailed:i}},function(c){function f(){b(".yle__global-header__navigation__links").removeClass("yle__global-header__navigation__links--open"),b(".yle__global-header__tunnus__links").removeClass("yle__global-header__tunnus__links--open"),b(".yle__global-header__navigation__toggle, .yle__global-header__tunnus__toggle").removeClass("yle__global-header__toggle--active")}function g(a){for(var c={"yle__global-header__tunnus__toggle":"tunnus","yle__global-header__tunnus__links":"tunnus_links","yle__global-header__navigation__toggle":"navigation","yle__global-header__navigation__links":"navigation_links","yle__global-header__search":"search","yle__global-header__logo":"logo"},d=Object.keys(c),e=0;e<d.length;e++){var f=d[e],g=b(a.target);if(g.hasClass(f)||g.parents("."+f).length>0)return c[f]}return"header"}var h={test:!1,siteUrl:"#",siteName:null,promoteTunnus:!1,loginApiAppId:null,loginApiAppKey:null,profilesApiAppId:null,profilesApiAppKey:null,search:{source:null,options:{},inputWidth:240},tracking:{account:"yleiset"}};null===c.siteName&&(console.debug("please provide site name!"),c.siteName="sitenamenotprovided"),e=b.extend(!0,{},h,c);var i=d.Tunnus(e),j=d.Navigation(e);d.Search(e,h,j);var k=e.siteName.toLowerCase().replace(/ /g,"_")+"_header_viewed";return e.promoteTunnus&&null===localStorage.getItem(k)&&a.addNotification({onDenotify:function(){localStorage.setItem(k,!0)}}),b("#header-logo-click").attr("href",e.siteUrl),b(".yle__global-header__logo__link").text(e.siteName),b("body").on("click",function(a){var c=b(a.target),d="yle__global-header__toggle";c.hasClass(d)===!1&&b(a.target).parents("."+d).length<=0&&f()}),b(".yle__global-header").on("click",function(a){b(this).trigger({type:"header-click",originalEvent:a,clickedItem:g(a)})}).on("close-menus",f).on("menu-open",f),b(".ylefi__tunnus-tos-accept__dialog").on("click",function(a){a.target===this&&(b(".ylefi__tunnus-tos-accept__button").off("click"),b(a.target).addClass("ylefi__tunnus-tos-accept__dialog--hidden"),d.sendTrackingEvent(e,"accept-tos-close-click"))}),{onLoginSuccess:i.onLoginSuccess,onLogoutSuccess:i.onLogoutSuccess,onLoginFailed:i.onLoginFailed,onLogoutFailed:i.onLogoutFailed,onAlreadyLoggedIn:i.onAlreadyLoggedIn,onNotLoggedIn:i.onLoginFailed,getHeight:function(){return b(".yle__global-header").height()}}}});